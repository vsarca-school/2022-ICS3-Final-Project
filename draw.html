<html>

<body>
    <style>
        #canvas_div {
            text-align: center;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        canvas {
            border: 2px solid black;
        }
    </style>

    <div id="canvas_div" style="overflow-x: auto;">
        <canvas id="canvas" width="560" height="560"></canvas>
        <button onclick="javascript:clearArea();return false;">Clear Area</button>
        Line width : <select id="selWidth">
            <option value="11">11</option>
            <option value="13" selected="selected">13</option>
            <option value="15">15</option>
        </select>
        Color : <select id="selColor">
            <option value="black">black</option>
            <option value="blue" selected="selected">blue</option>
            <option value="red">red</option>
            <option value="green">green</option>
            <option value="yellow">yellow</option>
            <option value="gray">gray</option>
        </select>
    </div>

    <script>
        let arr = new Array(28);
        for (let i = 0; i < 28; i++) {
            arr[i] = new Array(28).fill(0);
            console.log(arr[i]);
        }
        // When true, moving the mouse draws on the canvas
        let scale = 20;
        let drawing = false;
        let erasing = false;
        let x = 0;
        let y = 0;
        let dist = 0;
        let max = Math.sqrt(2)*(scale/2);
        let slope = 255/max;

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // event.offsetX, event.offsetY gives the (x,y) offset from the edge of the canvas.
        function drawPoint(e) {
            if (!drawing && !erasing) return;
            let x = e.offsetX/scale + 0.5;
            let y = e.offsetY/scale + 0.5;
            let x1 = x % 1;
            let y1 = y % 1;
            let x2 = 1 - x1;
            let y2 = 1 - y1;
            x = Math.floor(x);
            y = Math.floor(y);
            let color = 255 * (1 - x1*x1 - y1*y1);
            if (!drawing) color = 0;
            if (drawing && arr[x-1][y-1] < color || erasing && arr[x-1][y-1] > color)
            {
                arr[x-1][y-1] = color;
                ctx.fillStyle = `rgb(${color}, ${color}, ${color})`;
                ctx.fillRect((x-1) * scale, (y-1) * scale, scale, scale);
            }
            color = 255 * (1 - x2*x2 - y1*y1);
            if (!drawing) color = 0;
            if (drawing && arr[x][y-1] < color || erasing && arr[x][y-1] > color)
            {
                arr[x][y-1] = color;
                ctx.fillStyle = `rgb(${color}, ${color}, ${color})`;
                ctx.fillRect((x) * scale, (y-1) * scale, scale, scale);
            }
            color = 255 * (1 - x1*x1 - y2*y2);
            if (!drawing) color = 0;
            if (drawing && arr[x-1][y] < color || erasing && arr[x-1][y] > color)
            {
                arr[x-1][y] = color;
                ctx.fillStyle = `rgb(${color}, ${color}, ${color})`;
                ctx.fillRect((x-1) * scale, (y) * scale, scale, scale);
            }
            color = 255 * (1 - x2*x2 - y2*y2);
            if (!drawing) color = 0;
            if (drawing && arr[x][y] < color || erasing && arr[x][y] > color)
            {
                arr[x][y] = color;
                ctx.fillStyle = `rgb(${color}, ${color}, ${color})`;
                ctx.fillRect((x) * scale, (y) * scale, scale, scale);
            }
        }

        // Add the event listeners for mousedown, mousemove, and mouseup
        canvas.addEventListener('mousedown', (e) => {
            if (e.button == 0) drawing = true;
            else if (e.button == 1) erasing = true;
            drawPoint(e);
        });

        canvas.addEventListener('mousemove', drawPoint);

        canvas.addEventListener('mouseup', (e) => {
            if (e.button == 0) drawing = false;
            else if (e.button == 1) erasing = false;
        });

        function drawLine(ctx, x1, y1, x2, y2) {
            ctx.beginPath();
            ctx.strokeStyle = "white";
            ctx.lineWidth = document.getElementById('selWidth').value;
            ctx.lineJoin = "round";
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.closePath();
            ctx.stroke();
        }

        function clearArea() {
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
    </script>
</body>

</html>